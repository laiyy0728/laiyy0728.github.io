<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><style>.pace .pace-progress{background:#1e92fb;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1e92fb,0 0 5px #1e92fb}.pace .pace-activity{border-top-color:#1e92fb;border-left-color:#1e92fb}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><link rel="manifest" href="/images/manifest.json"><meta name="keywords" content="SpringCloud,"><link rel="alternate" href="/atom.xml" title="Laiyy 的个人小站" type="application/atom+xml"><meta name="description" content="应用是可以独立运行的程序代码，提供相对完善的业务功能。架构分为：业务架构、应用架构、技术架构。业务架构决定应用架构，技术架构支撑应用架构。架构的发展历程：单体架构 --&amp;gt; 分布式架构 --&amp;gt; SOA 架构 --&amp;gt; 微服务架构"><meta name="keywords" content="SpringCloud"><meta property="og:type" content="article"><meta property="og:title" content="Spring Cloud 微服务（2）                 &lt;BR&gt; 微服务与 Spring Cloud"><meta property="og:url" content="https://www.laiyy.top/spring-cloud/spring-cloud-2.html"><meta property="og:site_name" content="Laiyy 的个人小站"><meta property="og:description" content="应用是可以独立运行的程序代码，提供相对完善的业务功能。架构分为：业务架构、应用架构、技术架构。业务架构决定应用架构，技术架构支撑应用架构。架构的发展历程：单体架构 --&amp;gt; 分布式架构 --&amp;gt; SOA 架构 --&amp;gt; 微服务架构"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://www.laiyy.top/images/spring-cloud/infomation/single.png"><meta property="og:image" content="https://www.laiyy.top/images/spring-cloud/infomation/api.png"><meta property="og:updated_time" content="2019-01-16T06:32:19.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Spring Cloud 微服务（2）                 &lt;BR&gt; 微服务与 Spring Cloud"><meta name="twitter:description" content="应用是可以独立运行的程序代码，提供相对完善的业务功能。架构分为：业务架构、应用架构、技术架构。业务架构决定应用架构，技术架构支撑应用架构。架构的发展历程：单体架构 --&amp;gt; 分布式架构 --&amp;gt; SOA 架构 --&amp;gt; 微服务架构"><meta name="twitter:image" content="https://www.laiyy.top/images/spring-cloud/infomation/single.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.laiyy.top/spring-cloud/spring-cloud-2.html"><title>Spring Cloud 微服务（2）<br> 微服务与 Spring Cloud | Laiyy 的个人小站</title><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/laiyy0728" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Laiyy 的个人小站</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-关于我"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于我</a></li><li class="menu-item menu-item-标签"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-分类"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-归档"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.laiyy.top/spring-cloud/spring-cloud-2.html"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Laiyy"><meta itemprop="description" content=""><meta itemprop="image" content="/images/icon.jpg"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Laiyy 的个人小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Spring Cloud 微服务（2）<br> 微服务与 Spring Cloud</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-16T14:32:19+08:00">2019-01-16</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/spring-cloud/" itemprop="url" rel="index"><span itemprop="name">spring-cloud</span></a></span></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">2.1k 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">7 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p>应用是可以独立运行的程序代码，提供相对完善的业务功能。<br>架构分为：业务架构、应用架构、技术架构。业务架构决定应用架构，技术架构支撑应用架构。<br>架构的发展历程：<code>单体架构 --&gt; 分布式架构 --&gt; SOA 架构 --&gt; 微服务架构</code></p><a id="more"></a><h1 id="微服务概述"><a href="#微服务概述" class="headerlink" title="微服务概述"></a>微服务概述</h1><h2 id="单体应用架构"><a href="#单体应用架构" class="headerlink" title="单体应用架构"></a>单体应用架构</h2><p>单体架构可以理解为一个 Java Web 工程，包含：表现成、业务层、数据访问层。从 Controller 到 Service 到 Dao，没有任何应用拆分，开发完毕后打包成一个大型的 war 部署。</p><p><img src="/images/spring-cloud/infomation/single.png" alt="单体应用架构"></p><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul><li>便于发开：开发人员使用当前开发工具在短时间内就可以完成开发</li><li>便于测试：不需要依赖其他接口，节约时间</li><li>便于部署：只需将 war 部署到运行环境即可</li></ul><h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul><li>灵活度不够：如果程序有任何修改，需要自上而下全部修改，测试的时候也不要整个程序部署完才能看到效果。在开发过程中，可能会需要等待其他开发人员开发完成才能进行自己开发的内容。</li><li>降低系统性能：原本可以直接访问数据库，但多出了一个 Service 层</li><li>启动慢：一个进程中包含了所以的业务逻辑，涉及的模块过多</li><li>扩展性差：增加新的功能不能针对单个点增加，要全局性的增加，牵一发动全身</li></ul><h2 id="分布式架构"><a href="#分布式架构" class="headerlink" title="分布式架构"></a>分布式架构</h2><p>按照业务垂直切分，每个应用都是单体架构，通过 API 互相调用</p><p><img src="/images/spring-cloud/infomation/api.png" alt="分布式架构"></p><h2 id="面向服务的-SOA-架构"><a href="#面向服务的-SOA-架构" class="headerlink" title="面向服务的 SOA 架构"></a>面向服务的 SOA 架构</h2><p>SOA 架构有两个主要角色：服务的提供者（provider）、服务的消费者（consumer）。阿里的 Dubbo 的 SOA 的一个典型实现</p><h3 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h3><ul><li>模块拆分，使用接口通信，降低了模块之间的耦合度</li><li>把一个大项目拆分成多个子项目，可以并行开发</li><li>增加功能时只需要增加一个子项目，调用其他系统接口即可</li><li>可以灵活分布式部署</li></ul><h3 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h3><ul><li>系统之间需要远程通信，增加了开发的工作量</li></ul><h2 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h2><p>微服务架构是一种架构风格，对于大型复杂的业务系统，可以将业务功能拆分成多个相互独立的微服务，各个微服务之间是松耦合的，通过各种远程协议进行<code>同步/异步</code>通信，各个微服务可<code>单独部署</code>，<code>扩容/缩容</code>以及<code>升级/降级</code>。</p><h3 id="微服务技术选型对比"><a href="#微服务技术选型对比" class="headerlink" title="微服务技术选型对比"></a>微服务技术选型对比</h3><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Spring Cloud</th><th style="text-align:center">Dubbo</th><th style="text-align:center">Motan</th><th style="text-align:center">MSEC</th><th style="text-align:center">其他</th></tr></thead><tbody><tr><td style="text-align:center">功能</td><td style="text-align:center">微服务完整方案</td><td style="text-align:center">服务治理框架</td><td style="text-align:center">服务治理框架</td><td style="text-align:center">服务开发运营框架</td><td style="text-align:center">略</td></tr><tr><td style="text-align:center">通信方式</td><td style="text-align:center">REST / http</td><td style="text-align:center">RPC 协议</td><td style="text-align:center">RPC / Hessian2</td><td style="text-align:center">Protocol Buffers</td><td style="text-align:center">gRPC、thrift</td></tr><tr><td style="text-align:center">服务发现 / 注册</td><td style="text-align:center">Eureka（AP）</td><td style="text-align:center">ZK、Nacos</td><td style="text-align:center">ZK / Consul</td><td style="text-align:center">只有服务发现</td><td style="text-align:center">Etcd</td></tr><tr><td style="text-align:center">负载均衡</td><td style="text-align:center">Ribbon</td><td style="text-align:center">客户端负载</td><td style="text-align:center">客户端负载</td><td style="text-align:center">客户端负载</td><td style="text-align:center">Ngnix + Lua</td></tr><tr><td style="text-align:center">容错机制</td><td style="text-align:center">6 种</td><td style="text-align:center">6 种</td><td style="text-align:center">2 种</td><td style="text-align:center">自动容错</td><td style="text-align:center">keepalived、heartbeat</td></tr><tr><td style="text-align:center">熔断机制</td><td style="text-align:center">Hystrix</td><td style="text-align:center">无</td><td style="text-align:center">无</td><td style="text-align:center">过载保护</td><td style="text-align:center">无</td></tr><tr><td style="text-align:center">配置中心</td><td style="text-align:center">Spring Cloud Config</td><td style="text-align:center">Nacos</td><td style="text-align:center">无</td><td style="text-align:center">无</td><td style="text-align:center">Apollo、Nacos</td></tr><tr><td style="text-align:center">网关</td><td style="text-align:center">Zuul、Gateway</td><td style="text-align:center">无</td><td style="text-align:center">无</td><td style="text-align:center">无</td><td style="text-align:center">Kong、自研</td></tr><tr><td style="text-align:center">服务监控</td><td style="text-align:center">Hystrix + Turbine</td><td style="text-align:center">Dubbo + Monitor</td><td style="text-align:center">无</td><td style="text-align:center">Monitor</td><td style="text-align:center">ELK</td></tr><tr><td style="text-align:center">链路监控</td><td style="text-align:center">Sleuth + Zipkik</td><td style="text-align:center">无</td><td style="text-align:center">无</td><td style="text-align:center">无</td><td style="text-align:center">Pinpoint</td></tr><tr><td style="text-align:center">多语言</td><td style="text-align:center">REST 支持多语言</td><td style="text-align:center">Java</td><td style="text-align:center">Java</td><td style="text-align:center">Java、C++、PHP</td><td style="text-align:center">Java、PHP、Node.js</td></tr><tr><td style="text-align:center">社区活跃度</td><td style="text-align:center">高（Spring）</td><td style="text-align:center">高（阿里）</td><td style="text-align:center">一般</td><td style="text-align:center">未知</td><td style="text-align:center">略</td></tr></tbody></table><h2 id="基于-Spring-Cloud-的微服务解决方案"><a href="#基于-Spring-Cloud-的微服务解决方案" class="headerlink" title="基于 Spring Cloud 的微服务解决方案"></a>基于 Spring Cloud 的微服务解决方案</h2><table><thead><th style="text-align:center">组件</th><th style="text-align:center">方案1</th><th style="text-align:center">方案2</th><th style="text-align:center">方案3</th></thead><tbody><tr><td style="text-align:center">服务发现</td><td style="text-align:center">Eureka</td><td style="text-align:center">Consul</td><td style="text-align:center">etcd、Nacos</td></tr><tr><td style="text-align:center">共用组件</td><td style="text-align:center" colspan="3">服务调用：Feign、负载均衡：Ribbon、熔断器：Hystrix</td></tr><tr><td style="text-align:center">网关</td><td style="text-align:center" colspan="2">Zuul：性能低，SpringCloud Gateway：性能高</td><td style="text-align:center">自研</td></tr><tr><td style="text-align:center">配置中心</td><td style="text-align:center" colspan="3">SpringCloud Config、携程 Apollo、阿里 Nacos</td></tr><tr><td style="text-align:center">全链路监控</td><td style="text-align:center" colspan="3">Zipkin、Pinpoint、SkyWalking（推荐）</td></tr><tr><td style="text-align:center">其他</td><td style="text-align:center" colspan="3">分布式事务、Docker、gRPC、领域驱动 Halo</td></tr></tbody></table><p>基于 Dubbo 的解决方案使用 <code>Dubbo + Nacos</code>。Nacos 是阿里开源的一个构建云原生应用的动态服务发现、配置、服务管理平台。</p><hr><h1 id="Spring-Cloud"><a href="#Spring-Cloud" class="headerlink" title="Spring Cloud"></a>Spring Cloud</h1><h2 id="Spring-Cloud-介绍"><a href="#Spring-Cloud-介绍" class="headerlink" title="Spring Cloud 介绍"></a>Spring Cloud 介绍</h2><p>中间件：中间件是一种独立的系统软件或服务程序，分布式应用软件借助这种软件在不同的技术之间共享资源。中间件位于客户机/ 服务器的操作系统之上，管理计算机资源和网络通讯。是连接两个独立应用程序或独立系统的软件。<br>常见的中间件分别是：<code>服务治理(如 RPC)</code>、<code>配置中心</code>、<code>全链路监控</code>、<code>分布式事务</code>、<code>分布式定时任务</code>、<code>消息中间件</code>、<code>API 网关</code>、<code>分布式缓存</code>、<code>数据库中间件</code>等。</p><p>Spring Cloud 像是一个中间件，基于 <code>Spring Boot</code> 开发，提供一套完整的微服务解决方案。包括<code>服务注册与发现</code>、<code>配置中心</code>、<code>全链路监控</code>、<code>API 网关</code>、<code>熔断器</code> 等选型的中立的开源组件，可以随需扩展和替换组装。</p><h2 id="Spring-Cloud-项目模块"><a href="#Spring-Cloud-项目模块" class="headerlink" title="Spring Cloud 项目模块"></a>Spring Cloud 项目模块</h2><table><thead><tr><th style="text-align:center">组件名称</th><th style="text-align:center">所属项目</th><th style="text-align:center">组件分类</th></tr></thead><tbody><tr><td style="text-align:center">Eureka</td><td style="text-align:center">spring-cloud-netflix</td><td style="text-align:center">注册中心</td></tr><tr><td style="text-align:center">Zuul</td><td style="text-align:center">spring-cloud-netflix</td><td style="text-align:center">第一代网关</td></tr><tr><td style="text-align:center">Sidecar</td><td style="text-align:center">spring-cloud-netflix</td><td style="text-align:center">多语言支持</td></tr><tr><td style="text-align:center">Ribbon</td><td style="text-align:center">spring-cloud-netflix</td><td style="text-align:center">负载均衡</td></tr><tr><td style="text-align:center">Hystrix</td><td style="text-align:center">spring-cloud-netflix</td><td style="text-align:center">熔断器</td></tr><tr><td style="text-align:center">Turbine</td><td style="text-align:center">spring-cloud-netflix</td><td style="text-align:center">集群监控</td></tr><tr><td style="text-align:center">Feign</td><td style="text-align:center">spring-cloud-openfeign</td><td style="text-align:center">声明式的 HTTP 客户端</td></tr><tr><td style="text-align:center">Consul</td><td style="text-align:center">spring-cloud-consul</td><td style="text-align:center">注册中心</td></tr><tr><td style="text-align:center">Gateway</td><td style="text-align:center">spring-cloud-gateway</td><td style="text-align:center">第二代网关</td></tr><tr><td style="text-align:center">Sleuth</td><td style="text-align:center">spring-cloud-sleuth</td><td style="text-align:center">链路监控</td></tr><tr><td style="text-align:center">Config</td><td style="text-align:center">spring-cloud-config</td><td style="text-align:center">配置中心</td></tr><tr><td style="text-align:center">Bus</td><td style="text-align:center">spring-cloud-bus</td><td style="text-align:center">总线</td></tr><tr><td style="text-align:center">Pipeline</td><td style="text-align:center">spring-cloud-pipelines</td><td style="text-align:center">部署管道</td></tr><tr><td style="text-align:center">Dataflow</td><td style="text-align:center">spring-cloud-dataflow</td><td style="text-align:center">数据处理</td></tr><tr><td style="text-align:center">Stream</td><td style="text-align:center">spring-cloud-stream</td><td style="text-align:center">消息驱动</td></tr></tbody></table><h2 id="服务治理中间件"><a href="#服务治理中间件" class="headerlink" title="服务治理中间件"></a>服务治理中间件</h2><p>服务治理中间件包含：<code>服务注册与发现</code>、<code>服务路由</code>、<code>负载均衡</code>、<code>自我保护</code>、<code>管理机制</code>等。<br>其中，服务路由包含：<code>服务上下线</code>、<code>在线测试</code>、<code>机房就近选择</code>、<code>AB测试</code>、<code>灰度发布</code>等。<br>负载均衡包含：支持根据目标状态和目标权重进行负载均衡。<br>自我保护包含：<code>服务降级</code>、<code>优雅降级</code>、<code>流量控制</code></p><h2 id="注册中心对比"><a href="#注册中心对比" class="headerlink" title="注册中心对比"></a>注册中心对比</h2><table><thead><tr><th style="text-align:center">特性</th><th style="text-align:center">Consul</th><th style="text-align:center">Zookeeper</th><th style="text-align:center">etcd</th><th style="text-align:center">Eureka</th></tr></thead><tbody><tr><td style="text-align:center">服务健康检查</td><td style="text-align:center">服务状态、内存、硬盘等</td><td style="text-align:center">(弱)长连接、keepalive</td><td style="text-align:center">连接心跳</td><td style="text-align:center">可配置支持</td></tr><tr><td style="text-align:center">多数据中心</td><td style="text-align:center">支持</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">kv 存储服务</td><td style="text-align:center">支持</td><td style="text-align:center">支持</td><td style="text-align:center">支持</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">一致性</td><td style="text-align:center">raft</td><td style="text-align:center">paxos</td><td style="text-align:center">raft</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">CAP</td><td style="text-align:center">CA</td><td style="text-align:center">CP</td><td style="text-align:center">CP</td><td style="text-align:center">AP</td></tr><tr><td style="text-align:center">多语言支持</td><td style="text-align:center">https、dns</td><td style="text-align:center">客户端</td><td style="text-align:center">http/grpc</td><td style="text-align:center">http(sidecar)</td></tr><tr><td style="text-align:center">watch支持</td><td style="text-align:center">全量/支持long polling</td><td style="text-align:center">支持</td><td style="text-align:center">支持long polling</td><td style="text-align:center">支持 long polling/大部分增量</td></tr><tr><td style="text-align:center">自身健康</td><td style="text-align:center">metrics</td><td style="text-align:center">-</td><td style="text-align:center">metrics</td><td style="text-align:center">metrics</td></tr><tr><td style="text-align:center">安全</td><td style="text-align:center">acl/https</td><td style="text-align:center">acl</td><td style="text-align:center">https支持(弱)</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">Spring Cloud 集成</td><td style="text-align:center">支持</td><td style="text-align:center">支持</td><td style="text-align:center">支持</td><td style="text-align:center">支持</td></tr></tbody></table><h2 id="Spring-Cloud-配置中心功能需求"><a href="#Spring-Cloud-配置中心功能需求" class="headerlink" title="Spring Cloud 配置中心功能需求"></a>Spring Cloud 配置中心功能需求</h2><p>场景支持：</p><blockquote><p>面向全公司，充分考虑各部门需求，支持不同语言接入，充分考虑兼容性</p></blockquote><p>运维集成：</p><blockquote><p>统一数据源<br>标准化运维流程</p></blockquote><p>权限管理：</p><blockquote><p>接入权限、审核权限、下发权限…</p></blockquote><h2 id="Spring-Cloud-API-网关"><a href="#Spring-Cloud-API-网关" class="headerlink" title="Spring Cloud API 网关"></a>Spring Cloud API 网关</h2><p>API 网关是出现在系统边界上的一个面向 API 的、串行集中式的强管控服务，可以理解为应用的防火墙，主要起<code>隔离外部访问与内部系统</code>的作用。主要为了解决<code>访问认证</code>、<code>报文转发</code>、<code>访问统计</code>等问题。</p><p>API 网关需要提供的功能：</p><blockquote><p>统一接入功能：为各种服务提供统一接入服务，提供三高(高可用、高并发、高可靠)的网关服务，还需要支持负载均衡、容灾切换、异地多活<br>协议适配：对外提供 HTTP、HTTPS 访问，对内提供各种协议，如：HTTP、HTTPS、RPC、REST 等<br>流量监控：当大流量请求时，进行<code>流量监控</code>、<code>流量挑拨</code>；当后端出现异常时，需要进行<code>服务熔断</code>、<code>服务降级</code>；在异地多活中，需要进行<code>流量分片</code>等。<br>网关防护：所有请求进行安全过滤，对 IP 黑名单、URL 黑名单封禁、风控防刷、防恶意攻击等。</p></blockquote><p>Zuul、Gateway 的比较</p><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">Zuul</th><th style="text-align:center">Gateway</th></tr></thead><tbody><tr><td style="text-align:center">实现难度</td><td style="text-align:center">低</td><td style="text-align:center">高</td></tr><tr><td style="text-align:center">底层</td><td style="text-align:center">http、https、rest</td><td style="text-align:center">Netty</td></tr><tr><td style="text-align:center">灰度、降级、标签路由、限流、WAF封禁</td><td style="text-align:center">需要自定义 Filter</td><td style="text-align:center">配置</td></tr><tr><td style="text-align:center">安全、监控/埋点</td><td style="text-align:center">自定义 Intercepter</td><td style="text-align:center">自定义配置</td></tr></tbody></table><h2 id="Spring-Cloud-全链路监控"><a href="#Spring-Cloud-全链路监控" class="headerlink" title="Spring Cloud 全链路监控"></a>Spring Cloud 全链路监控</h2><p>全链路监控需要包含的功能：</p><blockquote><p>定位慢调用：慢 web 服务、慢 rest/rpc 服务、慢 SQL<br>定位错误：4XX、5XX、Service Error<br>定位异常：Error Exception、Fatal Exception<br>展现依赖和拓扑：域拓扑、服务拓扑、trace 拓扑<br>trace 调用链：将端到端的调用以及附加的上下文信息、异常日志信息、每个调用点的耗时都进行展示<br>应用警告：根据设置的警告规则，扫描指标数据，并进行信息上报</p></blockquote></div><div><div><div style="text-align:center;color:#bbb;font-size:15px"><br>-------------本文结束<i class="fa fa-paw"></i> 感谢您的阅读-------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> Laiyy</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.laiyy.top/spring-cloud/spring-cloud-2.html" title="Spring Cloud 微服务（2）                 <BR> 微服务与 Spring Cloud">https://www.laiyy.top/spring-cloud/spring-cloud-2.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/SpringCloud/" rel="tag"><i class="fa fa-tag"></i> SpringCloud</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/spring-cloud/spring-cloud-1.html" rel="next" title="Spring Cloud 微服务（1）                  <BR/> 思维导图"><i class="fa fa-chevron-left"></i> Spring Cloud 微服务（1）<br> 思维导图</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/spring-cloud/spring-cloud-3.html" rel="prev" title="Spring Cloud 微服务（3） --- Eureka(一) <BR> 注册中心与 Eureka">Spring Cloud 微服务（3） --- Eureka(一)<br> 注册中心与 Eureka<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="addthis_inline_share_toolbox"><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c42b60d6ef7b089" async="async"></script></div></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/icon.jpg" alt="Laiyy"><p class="site-author-name" itemprop="name">Laiyy</p><p class="site-description motion-element" itemprop="description">简介</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">55</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">8</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">19</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/laiyy0728" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:laiyy0728@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://www.jianshu.com/u/8fa6bf5f8bd9" target="_blank" title="简  书"><i class="fa fa-fw fa-book"></i> 简 书</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#微服务概述"><span class="nav-number">1.</span> <span class="nav-text">微服务概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#单体应用架构"><span class="nav-number">1.1.</span> <span class="nav-text">单体应用架构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#优点"><span class="nav-number">1.1.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缺点"><span class="nav-number">1.1.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分布式架构"><span class="nav-number">1.2.</span> <span class="nav-text">分布式架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向服务的-SOA-架构"><span class="nav-number">1.3.</span> <span class="nav-text">面向服务的 SOA 架构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#优点-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缺点-1"><span class="nav-number">1.3.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#微服务架构"><span class="nav-number">1.4.</span> <span class="nav-text">微服务架构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#微服务技术选型对比"><span class="nav-number">1.4.1.</span> <span class="nav-text">微服务技术选型对比</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基于-Spring-Cloud-的微服务解决方案"><span class="nav-number">1.5.</span> <span class="nav-text">基于 Spring Cloud 的微服务解决方案</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring-Cloud"><span class="nav-number">2.</span> <span class="nav-text">Spring Cloud</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Cloud-介绍"><span class="nav-number">2.1.</span> <span class="nav-text">Spring Cloud 介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Cloud-项目模块"><span class="nav-number">2.2.</span> <span class="nav-text">Spring Cloud 项目模块</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#服务治理中间件"><span class="nav-number">2.3.</span> <span class="nav-text">服务治理中间件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注册中心对比"><span class="nav-number">2.4.</span> <span class="nav-text">注册中心对比</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Cloud-配置中心功能需求"><span class="nav-number">2.5.</span> <span class="nav-text">Spring Cloud 配置中心功能需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Cloud-API-网关"><span class="nav-number">2.6.</span> <span class="nav-text">Spring Cloud API 网关</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Cloud-全链路监控"><span class="nav-number">2.7.</span> <span class="nav-text">Spring Cloud 全链路监控</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">UV:<span id="busuanzi_value_site_uv"></span></span></div> <span class="post-meta-divider">|</span><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_pv">PV:<span id="busuanzi_value_site_pv"></span></span></div><div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">laiyy</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">网站总字数&#58;</span> <span title="网站总字数">91.8k 字</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/three/three.min.js"></script><script type="text/javascript" src="/lib/three/three-waves.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script></body></html><script type="text/javascript" src="/js/src/clipboard.min.js"></script><script type="text/javascript" src="/js/src/clipboard-use.js"></script>