<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><style>.pace .pace-progress{background:#1e92fb;height:3px}.pace .pace-progress-inner{box-shadow:0 0 10px #1e92fb,0 0 5px #1e92fb}.pace .pace-activity{border-top-color:#1e92fb;border-left-color:#1e92fb}</style><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><link rel="manifest" href="/images/manifest.json"><meta name="keywords" content="SpringCloud,SpringBoot,Actuator,"><link rel="alternate" href="/atom.xml" title="Laiyy 的个人小站" type="application/atom+xml"><meta name="description" content="在 Hystrix Dashboard 中，使用了 /actuator/hystrix.stream，查看正在运行的项目的运行状态。 其中 /actuator 代表 SpringBoot 中的 Actuator 模块。该模版提供了很多生产级别的特性，如：监控、度量应用。Actuator 的特性可以通过众多的 REST 端点，远程 shell、JMX 获得。"><meta name="keywords" content="SpringCloud,SpringBoot,Actuator"><meta property="og:type" content="article"><meta property="og:title" content="Spring Cloud 微服务（18） --- Actuator(一) &lt;BR&gt; 常见端点、配置明细端点"><meta property="og:url" content="https://www.laiyy.top/spring-cloud/spring-cloud-18.html"><meta property="og:site_name" content="Laiyy 的个人小站"><meta property="og:description" content="在 Hystrix Dashboard 中，使用了 /actuator/hystrix.stream，查看正在运行的项目的运行状态。 其中 /actuator 代表 SpringBoot 中的 Actuator 模块。该模版提供了很多生产级别的特性，如：监控、度量应用。Actuator 的特性可以通过众多的 REST 端点，远程 shell、JMX 获得。"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://www.laiyy.top/images/spring-cloud/actuator/endpoints.png"><meta property="og:updated_time" content="2019-02-12T08:53:00.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Spring Cloud 微服务（18） --- Actuator(一) &lt;BR&gt; 常见端点、配置明细端点"><meta name="twitter:description" content="在 Hystrix Dashboard 中，使用了 /actuator/hystrix.stream，查看正在运行的项目的运行状态。 其中 /actuator 代表 SpringBoot 中的 Actuator 模块。该模版提供了很多生产级别的特性，如：监控、度量应用。Actuator 的特性可以通过众多的 REST 端点，远程 shell、JMX 获得。"><meta name="twitter:image" content="https://www.laiyy.top/images/spring-cloud/actuator/endpoints.png"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.laiyy.top/spring-cloud/spring-cloud-18.html"><title>Spring Cloud 微服务（18） --- Actuator(一)<br> 常见端点、配置明细端点 | Laiyy 的个人小站</title><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="https://github.com/laiyy0728" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Laiyy 的个人小站</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-首页"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-关于我"><a href="/about" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于我</a></li><li class="menu-item menu-item-标签"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-分类"><a href="/categories" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-归档"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.laiyy.top/spring-cloud/spring-cloud-18.html"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Laiyy"><meta itemprop="description" content=""><meta itemprop="image" content="/images/icon.jpg"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Laiyy 的个人小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Spring Cloud 微服务（18） --- Actuator(一)<br> 常见端点、配置明细端点</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-02-12T16:53:00+08:00">2019-02-12</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/spring-cloud/" itemprop="url" rel="index"><span itemprop="name">spring-cloud</span></a></span></span><div class="post-wordcount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">1.4k 字</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">6 分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p>在 Hystrix Dashboard 中，使用了 /actuator/hystrix.stream，查看正在运行的项目的运行状态。 其中 <code>/actuator</code> 代表 SpringBoot 中的 Actuator 模块。该模版提供了很多生产级别的特性，如：监控、度量应用。Actuator 的特性可以通过众多的 REST 端点，远程 shell、JMX 获得。</p><a id="more"></a><p><strong><em>源码：<a href="https://gitee.com/laiyy0728/spring-cloud/tree/master/spring-boot-actuator" target="_blank" rel="noopener">https://gitee.com/laiyy0728/spring-cloud/tree/master/spring-boot-actuator</a></em></strong></p><h1 id="常见-Actuator-端点"><a href="#常见-Actuator-端点" class="headerlink" title="常见 Actuator 端点"></a>常见 Actuator 端点</h1><p><img src="/images/spring-cloud/actuator/endpoints.png" alt="Actuator endpoints 端点"></p><p><em>路径省略前缀：/actuator</em></p><table><thead><tr><th style="text-align:center">路径</th><th style="text-align:center">HTTP 动作</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">/conditions</td><td style="text-align:center">GET</td><td style="text-align:center">提供了一份自动配置报告，记录哪些自动配置条件通过了，哪些没通过</td></tr><tr><td style="text-align:center">/configprops</td><td style="text-align:center">GET</td><td style="text-align:center">描述配置属性（包含默认值）如何注入 Bean</td></tr><tr><td style="text-align:center">/caches</td><td style="text-align:center">GET</td><td style="text-align:center">获取所有的 Cachemanager</td></tr><tr><td style="text-align:center">/caches/{cache}</td><td style="text-align:center">DELETE</td><td style="text-align:center">移除某个 CacheManager</td></tr><tr><td style="text-align:center">/beans</td><td style="text-align:center">GET</td><td style="text-align:center">描述应用程序上下文全部 bean，以及他们的关系</td></tr><tr><td style="text-align:center">/threaddump</td><td style="text-align:center">GET</td><td style="text-align:center">获取线程活动快照</td></tr><tr><td style="text-align:center">/env</td><td style="text-align:center">GET</td><td style="text-align:center">获取全部环境属性</td></tr><tr><td style="text-align:center">/env/{toMatch}</td><td style="text-align:center">GET</td><td style="text-align:center">获取指定名称的特定环境的属性值</td></tr><tr><td style="text-align:center">/health</td><td style="text-align:center">GET</td><td style="text-align:center">报告应用长须的健康指标，由 HealthIndicator 的实现提供</td></tr><tr><td style="text-align:center">/httptrace</td><td style="text-align:center">GET</td><td style="text-align:center">提供基本的 HTTP 请求跟踪信息(时间戳、HTTP 头等)</td></tr><tr><td style="text-align:center">/info</td><td style="text-align:center">GET</td><td style="text-align:center">获取应用程序定制信息，由 Info 开头的属性提供</td></tr><tr><td style="text-align:center">/loggers</td><td style="text-align:center">GET</td><td style="text-align:center">获取 bean 的日志级别</td></tr><tr><td style="text-align:center">/loggers/{name}</td><td style="text-align:center">GET</td><td style="text-align:center">获取某个 包、类 路径端点的日志级别</td></tr><tr><td style="text-align:center">/loggers/{name}</td><td style="text-align:center">POST</td><td style="text-align:center">新增某个 包、类 路径端点的日志级别</td></tr><tr><td style="text-align:center">/mappings</td><td style="text-align:center">GET</td><td style="text-align:center">描述全部的 URL 路径，以及它们和控制器(包含Actuator端点)的映射关系</td></tr><tr><td style="text-align:center">/metrics</td><td style="text-align:center">GET</td><td style="text-align:center">报告各种应用程序度量信息，如：内存用量、HTTP 请求计数</td></tr><tr><td style="text-align:center">/metrics/{name}</td><td style="text-align:center">GET</td><td style="text-align:center">根据名称获取度量信息</td></tr><tr><td style="text-align:center">/shutdown</td><td style="text-align:center">POST</td><td style="text-align:center">关闭应用，要求 endpoints.shutdown.enabled 为 true</td></tr><tr><td style="text-align:center">/scheduledtasks</td><td style="text-align:center">GET</td><td style="text-align:center">获取所有定时任务信息</td></tr></tbody></table><p>SpringCloud 中，默认开启了 <code>/actuator/health</code>、<code>/actuator/info</code> 端点，其他端点都屏蔽掉了。如果需要开启，自定义开启 endpoints 即可<br></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line"><span class="attr">  endpoints:</span></span><br><span class="line"><span class="attr">    web:</span></span><br><span class="line"><span class="attr">      exposure:</span></span><br><span class="line"><span class="attr">        exclude:</span> <span class="string">['health','info','beans','env']</span></span><br></pre></td></tr></table></figure><p></p><p>如果要开启全部端点，设置 <code>exclude: *</code> 即可</p><hr><h1 id="配置明细端点"><a href="#配置明细端点" class="headerlink" title="配置明细端点"></a>配置明细端点</h1><p>引入pom文件，设置 yml<br></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line"><span class="attr">  endpoints:</span></span><br><span class="line"><span class="attr">    web:</span></span><br><span class="line"><span class="attr">      exposure:</span></span><br><span class="line"><span class="attr">        include:</span> <span class="string">'*'</span></span><br></pre></td></tr></table></figure><h2 id="beans-端点"><a href="#beans-端点" class="headerlink" title="beans 端点"></a>beans 端点</h2><p>使用 /actuator/beans 端点，获取 JSON 格式的 bean 装配信息。访问： <a href="http://localhost:8080/actuator/beans" target="_blank" rel="noopener">http://localhost:8080/actuator/beans</a><br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"contexts"</span>: &#123;</span><br><span class="line">		<span class="attr">"application"</span>: &#123;</span><br><span class="line">			<span class="attr">"beans"</span>: &#123;</span><br><span class="line">				"webEndpointDiscoverer": &#123;    // bean 名称</span><br><span class="line">					"aliases": [],    // bean 别名</span><br><span class="line">					"scope": "singleton",   // bean 作用域</span><br><span class="line">					"type": "org.springframework.boot.actuate.endpoint.web.annotation.WebEndpointDiscoverer",   // bean 类型</span><br><span class="line">					"resource": "class path resource [org/springframework/boot/actuate/conditionsure/endpoint/web/WebEndpointconditionsuration.class]",   // class 文件物理地址</span><br><span class="line">					"dependencies": [   // 当前 bean 注入的 bean 的列表</span><br><span class="line">						"endpointOperationParameterMapper",</span><br><span class="line">						<span class="string">"endpointMediaTypes"</span></span><br><span class="line">					]</span><br><span class="line">				&#125;,</span><br><span class="line">				"parentId": null</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h2 id="conditions-端点"><a href="#conditions-端点" class="headerlink" title="conditions 端点"></a>conditions 端点</h2><p>/beans 端点可以看到当前 Spring 上下文有哪些 bean， /conditions 端点可以看到为什么有这个 bean<br>SpringBoot 自动配置构建与 Spring 的条件化配置之上，提供了众多的 <code>@Conditional</code> 注解的配置类，根据 <code>@Conditional</code> 条件决定是否自动装配这些 bean。<br>/conditions 端点提供了一个报告，列出了所有条件，根据条件是否通过进行分组</p><p>访问 <a href="http://localhost:8080/actuator/conditions" target="_blank" rel="noopener">http://localhost:8080/actuator/conditions</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"contexts"</span>: &#123;</span><br><span class="line">		<span class="attr">"application"</span>: &#123;</span><br><span class="line">			"positiveMatches": &#123;    // 成功的自动装配</span><br><span class="line">				"AuditEventsEndpointAutoConfiguration#auditEventsEndpoint": [&#123;</span><br><span class="line">						"condition": "OnBeanCondition",   // 装配条件</span><br><span class="line">						"message": "@ConditionalOnBean (types: org.springframework.boot.actuate.audit.AuditEventRepository; SearchStrategy: all) found bean 'auditEventRepository'; @ConditionalOnMissingBean (types: org.springframework.boot.actuate.audit.AuditEventsEndpoint; SearchStrategy: all) did not find any beans"    // 装配信息</span><br><span class="line">					&#125;,</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="attr">"condition"</span>: <span class="string">"OnEnabledEndpointCondition"</span>,</span><br><span class="line">						<span class="attr">"message"</span>: <span class="string">"@ConditionalOnEnabledEndpoint no property management.endpoint.auditevents.enabled found so using endpoint default"</span></span><br><span class="line">					&#125;</span><br><span class="line">				],</span><br><span class="line">      &#125;,</span><br><span class="line">			"negativeMatches": &#123;      // 失败的自动装配</span><br><span class="line">        "RabbitHealthIndicatorAutoConfiguration": &#123;</span><br><span class="line">          "notMatched": [   // 没有匹配到的条件</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"condition"</span>: <span class="string">"OnClassCondition"</span>,</span><br><span class="line">              <span class="attr">"message"</span>: <span class="string">"@ConditionalOnClass did not find required class 'org.springframework.amqp.rabbit.core.RabbitTemplate'"</span></span><br><span class="line">            &#125;],</span><br><span class="line">            "matched": []   // 匹配到的条件</span><br><span class="line">          &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">			"unconditionalClasses": [     // 无条件装配</span><br><span class="line">        <span class="string">"org.springframework.boot.actuate.autoconfigure.management.HeapDumpWebEndpointAutoConfiguration"</span></span><br><span class="line">      ]</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到，在 <code>negativeMatches</code> 的 <code>RabbitHealthIndicatorAutoConfiguration</code> 自动状态，没有匹配到 <code>org.springframework.amqp.rabbit.core.RabbitTemplate</code> 类，所有没有自动装配。</p><h2 id="env-端点"><a href="#env-端点" class="headerlink" title="env 端点"></a>env 端点</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	"activeProfiles": [],   // 启用的 profile </span><br><span class="line">	"propertySources": [&#123;</span><br><span class="line">			"name": "server.ports",   // 端口设置</span><br><span class="line">			"properties": &#123;</span><br><span class="line">				"local.server.port": &#123;</span><br><span class="line">					"value": 8080   // 本地端口</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			"name": "servletContextInitParams",   // servlet 上下文初始化参数信息</span><br><span class="line">			"properties": &#123;&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			"name": "systemProperties",     // 系统配置</span><br><span class="line">			"properties": &#123;</span><br><span class="line">        "java.runtime.name": &#123;    // 配置名称</span><br><span class="line">          "value": "Java(TM) SE Runtime Environment"    // 配置值</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			"name": "systemEnvironment",    // 系统环境</span><br><span class="line">			"properties": &#123;</span><br><span class="line">        "USERDOMAIN_ROAMINGPROFILE": &#123;    </span><br><span class="line">          "value": "DESKTOP-QMHTL6V",   // 环境名称</span><br><span class="line">          "origin": "System Environment Property \"USERDOMAIN_ROAMINGPROFILE\""   // 环境值</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			"name": "applicationConfig: [classpath:/application.yml]",    // 配置文件信息</span><br><span class="line">			"properties": &#123;</span><br><span class="line">				"management.endpoints.web.exposure.include": &#123;      // 配置文件 key</span><br><span class="line">					"value": "*",       // 配置文件 value</span><br><span class="line">					"origin": "class path resource [application.yml]:5:18"    // 位置</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="mappings-端点"><a href="#mappings-端点" class="headerlink" title="mappings 端点"></a>mappings 端点</h2><p>mappings 端点可以生成一份 <code>控制器到端点</code> 的映射，即 访问路径与控制器 的映射</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="attr">"contexts"</span>: &#123;</span><br><span class="line">		<span class="attr">"application"</span>: &#123;</span><br><span class="line">			<span class="attr">"mappings"</span>: &#123;</span><br><span class="line">				"dispatcherServlets": &#123;   // 所有的 DispatcherServlet</span><br><span class="line">					"dispatcherServlet": [&#123; // DispatcherServlet</span><br><span class="line">							"handler": "ResourceHttpRequestHandler [class path resource [META-INF/resources/], class path resource [resources/], class path resource [static/], class path resource [public/], ServletContext resource [/], class path resource []]",   // 处理器</span><br><span class="line">							"predicate": "/**/favicon.ico",   // 映射路径</span><br><span class="line">							"details": null</span><br><span class="line">						&#125;,</span><br><span class="line">						&#123;</span><br><span class="line">							<span class="attr">"handler"</span>: <span class="string">"public java.lang.Object org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping$OperationHandler.handle(javax.servlet.http.HttpServletRequest,java.util.Map&lt;java.lang.String, java.lang.String&gt;)"</span>,</span><br><span class="line">							"predicate": "&#123;[/actuator/auditevents],methods=[GET],produces=[application/vnd.spring-boot.actuator.v2+json || application/json]&#125;",   // 断言（包含端点、请求方式、类型等）</span><br><span class="line">							"details": &#123;    // 详细信息</span><br><span class="line">								"handlerMethod": &#123;  // 处理器</span><br><span class="line">									"className": "org.springframework.boot.actuate.endpoint.web.servlet.AbstractWebMvcEndpointHandlerMapping.OperationHandler", // handle 实现类</span><br><span class="line">									"name": "handle", // 处理器名称</span><br><span class="line">									"descriptor": "(Ljavax/servlet/http/HttpServletRequest;Ljava/util/Map;)Ljava/lang/Object;"    // 描述符</span><br><span class="line">								&#125;,</span><br><span class="line">								"requestMappingConditions": &#123;   // 请求映射条件</span><br><span class="line">									"consumes": [],   // 入参类型</span><br><span class="line">									"headers": [],    // 入参头</span><br><span class="line">									"methods": [      // 请求方式</span><br><span class="line">										<span class="string">"GET"</span></span><br><span class="line">									],</span><br><span class="line">									"params": [],     // 参数</span><br><span class="line">									"patterns": [</span><br><span class="line">										"/actuator/auditevents"   // 请求 URL</span><br><span class="line">									],</span><br><span class="line">									"produces": [&#123;    // 返回值类型</span><br><span class="line">											"mediaType": "application/vnd.spring-boot.actuator.v2+json",</span><br><span class="line">											"negated": false</span><br><span class="line">										&#125;,</span><br><span class="line">										&#123;</span><br><span class="line">											<span class="attr">"mediaType"</span>: <span class="string">"application/json"</span>,</span><br><span class="line">											<span class="attr">"negated"</span>: <span class="literal">false</span></span><br><span class="line">										&#125;</span><br><span class="line">									]</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					]</span><br><span class="line">				&#125;,</span><br><span class="line">				"servletFilters": [&#123;    // 所有 Filters</span><br><span class="line">						"servletNameMappings": [],    // servlet 名称映射</span><br><span class="line">						"urlPatternMappings": [</span><br><span class="line">							"/*"      // filter 过滤路径</span><br><span class="line">						],</span><br><span class="line">						"name": "webMvcMetricsFilter",    // filter 名称</span><br><span class="line">						"className": "org.springframework.boot.actuate.metrics.web.servlet.WebMvcMetricsFilter"   // Filter 实现类</span><br><span class="line">					&#125;</span><br><span class="line">				],</span><br><span class="line">				"servlets": [&#123;    // 所有 Servlet</span><br><span class="line">						"mappings": [],   // 映射</span><br><span class="line">						"name": "default",    // servlet 名称</span><br><span class="line">						"className": "org.apache.catalina.servlets.DefaultServlet"    // servlet 实现类</span><br><span class="line">					&#125;,</span><br><span class="line">					&#123;</span><br><span class="line">						<span class="attr">"mappings"</span>: [</span><br><span class="line">							<span class="string">"/"</span></span><br><span class="line">						],</span><br><span class="line">						<span class="attr">"name"</span>: <span class="string">"dispatcherServlet"</span>,</span><br><span class="line">						<span class="attr">"className"</span>: <span class="string">"org.springframework.web.servlet.DispatcherServlet"</span></span><br><span class="line">					&#125;</span><br><span class="line">				]</span><br><span class="line">			&#125;,</span><br><span class="line">			"parentId": null</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div><div><div style="text-align:center;color:#bbb;font-size:15px"><br>-------------本文结束<i class="fa fa-paw"></i> 感谢您的阅读-------------</div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"> <strong>本文作者：</strong> Laiyy</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.laiyy.top/spring-cloud/spring-cloud-18.html" title="Spring Cloud 微服务（18） --- Actuator(一) <BR> 常见端点、配置明细端点">https://www.laiyy.top/spring-cloud/spring-cloud-18.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/SpringCloud/" rel="tag"><i class="fa fa-tag"></i> SpringCloud</a><a href="/tags/SpringBoot/" rel="tag"><i class="fa fa-tag"></i> SpringBoot</a><a href="/tags/Actuator/" rel="tag"><i class="fa fa-tag"></i> Actuator</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/spring-cloud/spring-cloud-17.html" rel="next" title="Spring Cloud 微服务（17） ---Hystrix(五) <BR> Hystrix 优化"><i class="fa fa-chevron-left"></i> Spring Cloud 微服务（17） ---Hystrix(五)<br> Hystrix 优化</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/spring-cloud/spring-cloud-19.html" rel="prev" title="Spring Cloud 微服务（19） --- Actuator(二) <BR> 运行时度量">Spring Cloud 微服务（19） --- Actuator(二)<br> 运行时度量<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"><div class="addthis_inline_share_toolbox"><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5c42b60d6ef7b089" async="async"></script></div></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/icon.jpg" alt="Laiyy"><p class="site-author-name" itemprop="name">Laiyy</p><p class="site-description motion-element" itemprop="description">简介</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives"><span class="site-state-item-count">72</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">15</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">31</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/laiyy0728" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:laiyy0728@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://www.jianshu.com/u/8fa6bf5f8bd9" target="_blank" title="简  书"><i class="fa fa-fw fa-book"></i> 简 书</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#常见-Actuator-端点"><span class="nav-number">1.</span> <span class="nav-text">常见 Actuator 端点</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#配置明细端点"><span class="nav-number">2.</span> <span class="nav-text">配置明细端点</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#beans-端点"><span class="nav-number">2.1.</span> <span class="nav-text">beans 端点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#conditions-端点"><span class="nav-number">2.2.</span> <span class="nav-text">conditions 端点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#env-端点"><span class="nav-number">2.3.</span> <span class="nav-text">env 端点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mappings-端点"><span class="nav-number">2.4.</span> <span class="nav-text">mappings 端点</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">UV:<span id="busuanzi_value_site_uv"></span></span></div> <span class="post-meta-divider">|</span><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_pv">PV:<span id="busuanzi_value_site_pv"></span></span></div><div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">laiyy</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-area-chart"></i></span> <span class="post-meta-item-text">网站总字数&#58;</span> <span title="网站总字数">126.7k 字</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/three/three.min.js"></script><script type="text/javascript" src="/lib/three/three-waves.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script></body></html><script type="text/javascript" src="/js/src/clipboard.min.js"></script><script type="text/javascript" src="/js/src/clipboard-use.js"></script>